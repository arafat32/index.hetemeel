!function(){var e={27142:function(){$(document).on("click","#allowConversationsIM",(function(){window.showInboxAllowModal=!1,window.receiverId&&$.post("/inbox_user_allow_conversation/"+window.receiverId,"json"),window.bus.$emit("open-individual-message-popup",{popupData:window.popupIndividuals[window.receiverId],text:""})})),$(document).on("click","#notAllowConversations",(function(){window.showInboxAllowModal=!1,$(".userbanner").length?window.bus.$emit("open-individual-message-popup",{popupData:window.popupIndividuals[window.receiverId],text:""}):$(".message-submit-button button").trigger("click")})),window.individualMessageModule=function(){var t,o,n={},i={},a={},s={},r=!1,d=!1,u=!1,c=$(".modal-individual-message"),p=$(".js-individual-message-send"),f=!1,g=!1,h="#message_body";window.isChat&&(h="#message_body_offer");var w=$(h),v=function(){return $(".js-send-order-message-radio:checked").length>0},m=function(e){return 0!==i.length&&0!==a.length&&(e?""!==i.get(0).value&&""!==a.get(0).value:""!==i.get(0).value||""!==a.get(0).value)},b=function(e,t){t?$(".js-individual-message-textarea-error").html(e).removeClass("hidden"):$(".js-individual-message-error").html(e).removeClass("hidden")},C=function(){$(".js-individual-message-error, .js-individual-message-textarea-error").html("").addClass("hidden")},_=function(){var e=parseInt(i.val());return isNaN(e)||e>=minBudget&&e<=maxBudget},y=function(e){var n=$(h),i=n.val();if(r=i>""&&i.replace(/\s/g,"").length&&(d||t&&t.canSave())&&!1===u,n.length<1)return!1;if(r)if(window.legacyTextCheck){var a=n.val().length;r=a>=parseInt(n.data("textCounterMin"))&&a<=parseInt(n.data("textCounterMax"))}else n.get(0).textCounter&&(r=!n.get(0).textCounter.hasError);window.isChat&&r&&(r=""!==$("#budget").val()&&""!==$("#request-kwork-duration-offer").get(0).value,e||(r=!1));var s="disabled";(o||window.forceNewSubmitButtons)&&(s="kw-button--inactive"),r?p.prop("disabled",!1).removeClass("kw-button--loading").removeClass(s):(p.prop("disabled",!0).addClass(s),!0===u&&p.addClass("kw-button--loading"))},k=function(){$(document).on("click",".js-individual-message__popup-link",(function(){var e=$(".js-chat-redirect-url");if(!window.CheckEmailVerified.checkEmail())return!1;$(".js-currency-ru").toggleClass("hidden",offerLang!==window.langDefault),$(".js-currency-en").toggleClass("hidden",offerLang===window.langDefault),0===$(".load-file__list .file-uploader__item").length&&$(".file-uploader__add-text").text(l("attachFile","components/individual-message"));var t=$(this).data("user-id")||window.userProfileId;if(1===isPageNeedSmsVerification){if(isSmsVerified){if(window.hasConversation)return document.location.href=window.chatRedirectUrl,!1;if(e.attr("data-url",window.chatRedirectUrl),!0===window.showInboxAllowModal&&window.receiverId)return window.popupAllowConversations("allowConversationsIM"),!1;window.isChat?individualMessageModule.showMessage():window.bus.$emit("open-individual-message-popup",{popupData:window.popupIndividuals[t],text:"",noFade:isMobile()})}else window.bus.$emit("phone-setting-modal-open");return!1}return window.hasConversation?(document.location.href=window.chatRedirectUrl,!1):(e.attr("data-url",window.chatRedirectUrl),!0===window.showInboxAllowModal&&window.receiverId?(window.popupAllowConversations("allowConversationsIM"),!1):void(window.isChat?individualMessageModule.showMessage():window.bus.$emit("open-individual-message-popup",{popupData:window.popupIndividuals[t],text:""})))})),window.isChat||($.browser.ios&&function(e,t){if(!e)return!1;$(document).on("focus",e,(function(e){var o=$(window);o.scrollTop(10);var n=$(window).scrollTop()>0;o.scrollTop(0),n&&t.open&&t.open.call(e.currentTarget)})),$(document).on("blur",e,(function(e){t.close&&t.close.call(e.currentTarget)}))}(w,{open:function(){var e,t;w.data("ios-keyboard",(e=window.screen.height)in(t={568:253,667:270,736:271,812:346,896:356})?t[e]:.4*e),window.screen.height<=667&&w.addClass("field-auto-height__textarea--small-screen"),x()},close:function(){w.removeClass("field-auto-height__textarea--small-screen"),w.removeData("ios-keyboard"),x()}}),w.on("focus",j).on("blur",j).on("input",(function(){x()})),$(window).on("resize",Utils.debounce(x,200))),c.on("hidden.bs.modal",(function(){$(".js-orders-between-users-list").html("").parent().addClass("hidden"),f&&f.setStage(1),f=!1,o&&($(".js-offer-individual-message-duration-wrapper").removeClass("active"),window.appFilesOffer.$refs.fileUploader.clearFiles())})),c.on("shown.bs.modal",(function(){I(),window.chosenSearch.init($(".js-offer-individual-message-duration:visible"),{width:"122px",disable_search:!1,display_disabled_options:!1})}))},j=function(e){$(".field-auto-height__wrapper").toggleClass("field-auto-height__wrapper--focused","focus"===e.type)},x=function(){if(!$(".modal-individual-message").is(":visible"))return!1;var e=$(".modal-individual-message__stage"),t=e&&e.is(":visible");if(isMobile()&&!t)return w.css({height:108}),!1;var o,n=$(".field-auto-height__wrapper"),i=$(".field-auto-height__sizer");w.length<1||(w.val(w.val().split("          ").join(" ")),i.text(w.val()),setTimeout((function(){o=i.outerHeight(),t&&isMobile()&&function(){var e=0;w.data("ios-keyboard")&&(e+=w.data("ios-keyboard"));var t=$(".modal-individual-message__stage"),o=t.outerHeight()-w.outerHeight(),n=$(t.parents(".modal-body")[0]);o+=parseInt(n.css("padding-top").split("px")[0])+parseInt(n.css("padding-bottom").split("px")[0]);var i=$(t.parents(".modal-content")[0]);o+=$(i.children(".modal-header")[0]).outerHeight();var a=i.outerHeight()-o-10-e;a>0?w.css({maxHeight:a}):w.css({maxHeight:w.css("min-height")})}(),w.css({height:o}),n.toggleClass("field-auto-height__wrapper--overflow--visible",o>324)}),0))},S=function(e,t){var o=$("<div/>",{class:"break-word mt10"}),n=$("<input/>",{type:"radio",name:"orderId",id:"orderId"+t.id,value:t.id,class:"js-send-order-message-radio styled-radio"}),i=$("<label/>",{for:"orderId"+t.id,text:t.kwork_title});return o.append(n),o.append(i),o},I=function(){var t=c.find(".js-form-stages"),o=c.find(".js-send-order-message-radio"),n=t.find("[data-stage]").length>1,i=o.length>1;!g&&t.length>0&&n&&i&&(f=new e(t))},M=function(){var e=c.find(".js-send-order-message-radio");return 1===e.length?(e.prop("checked",!0),g=!0):(e.prop("checked",!1),g=!1),g};return{init:function(){"undefined"!=typeof FileUploader?t=new FileUploader({files:{},selector:"#load-files-conversations",input:{name:"conversations-files"},buttonDisabled:".js-uploader-button-disable",isMiniature:!0}):d=!0,o=window.isChat&&window.appFilesOffer&&window.appFilesOffer.$refs.fileUploader.files,y(!0),k(),M(),I()},showMessage:function(e){var t=$(".js-individual-message-form"),r=$("#individual-message-modal-success");t.off("submit"),function(){if((n=$(".modal-individual-message")).find(".textarea-style--error, .has-error").removeClass("textarea-style--error has-error"),C(),n.modal&&n.modal("show"),n=n.find(".popup-individual-message"),i=n.find("input[name=budget]"),a=n.find("select[name=kwork_duration]"),s=n.find("textarea[name=message_body]"),$(".js-send-order-message-radio").on("change",(function(){v()&&C()})),s.on("input",(function(){C()})),a.on("change",(function(){C()})),i.on("change",(function(){C()})),i.on("change keyup blur",(function(e){$(e.target).val($(e.target).val().replace(/[^0-9]/gi,"")),y(!0)})),$(document).off("input.durationSubmitControl").on("input.durationSubmitControl",h+", #request-kwork-duration-offer",(function(){y(!0)})),!window.isChat){x();var e=w.val();w.val("").focus().val(e)}y(!0)}(),t.on("submit",(function(e){if(e.preventDefault(),o){var t=$(".js-offer-files");t.text(""),$.each(window.appFilesOffer.$refs.fileUploader.files,(function(e,o){o.result&&"success"===o.result&&t.append('<input type="hidden" name="conversations-files[new][]" value="'+o.file_id+'">')}))}var i=$(this);return!(!m(!0)&&f&&f.nextStage())&&(n.find(".js-send-order-message-radio").length>1&&!m()&&s.val().length>0&&!v()&&"individual_message"===n.find("input[name=message_type]").val()?(b(l("selectOrder","components/individual-message")),!1):_()?(u=!0,y(!0),void $.ajax({url:"/sendmessage",method:"post",data:i.serialize(),dataType:"json",success:function(e){if(window.isChat)return u=!1,"error"===e.status?(b(e.response),!1):(e.MID&&window.conversationApp.$refs.conversationMessagesList.applyServerData([e],!0),chatModule.individualMessageToggle("close"),setTimeout((function(){chatModule.scrollToEnd(),window.trumbowygCaret.focusCaret($(".trumbowyg-textarea")),y(!0)}),200),newMessageForm.find(".js-stopwords-warning-container").text(""),!1);if(e.code&&201==+e.code)window.bus.$emit("phone-setting-modal-open"),u=!1,y(!0);else{if("success"===e.status)return e.redirect.match(/track|email_confirm/gi)?e.redirect.match(/email_confirm/gi)?(window.CheckEmailVerified.showNotVerified(),!1):(location.href=e.redirect,!1):($(".modal-individual-message").modal("hide"),r.modal("show"),window.hasConversation=!0,!1);if("error"===e.status)b(e.response,!0),e.reload&&setTimeout((function(){window.location.reload()}),1e3);else if("MID"in e)return r.length>0?($(".modal-individual-message").modal("hide"),r.modal("show"),window.hasConversation=!0,GTM.pushDataLayer({event:"ChatWithSellerStarted"})):location.href=$(".js-chat-redirect-url").attr("data-url"),!1;u=!1,y(!0)}},error:function(){u=!1,y(!0)},complete:function(){p.removeClass("kw-button--loading")}})):(b(l("priceCanBe","components/individual-message",['<span class="d-inline-block dib">'.concat(Utils.priceFormatWithSign(minBudget,offerLang),"</span>"),'<span class="d-inline-block dib">'.concat(Utils.priceFormatWithSign(maxBudget,offerLang),"</span>")])),!1))}));var d=window.isSinglePageWant?null:$(h).get(0).textCounter;d&&d.on("counter:input",(function(e){e.checkMin(),y(!0)})),e&&e()},renderOrdersByUserId:function(e,t){var o=window.ordersBetweenUsersArray&&window.ordersBetweenUsersArray[e],n=t.find(".js-orders-between-users-list"),i=n.parent();if(!(o&&n.length>0))return i.addClass("hidden"),!1;i.removeClass("hidden"),$.each(window.ordersBetweenUsersArray[e],(function(e,t){var o=S(e,t);n.append(o)})),M(),I()},isCorrectBudget:_,setError:b,unsetError:C,setSubmitButton:y}}(),$((function(){addScriptToQueue((function(){individualMessageModule.init(),window.defferScripts.on("tooltipster",(function(){$("#new-desktop-submit.tooltipstered").mouseenter((function(){$(this).tooltipster("disable"),$(this).tooltipster("enable")}))}))}));var e=$(".js-user-time");if(e.length){var t=e.data("user-timezone"),o=new DateTime.fromSeconds(parseInt(Utils.getServerTime())).setZone(t).minute,n=!1;setInterval((function(){var i=new DateTime.fromSeconds(parseInt(Utils.getServerTime())).setZone(t),a=i.minute;o!==a&&(IS_MARKET_APP_RU?e.text(i.toFormat("HH:mm")):e.text(i.toFormat("hh:mm a").replace(/(a|p)m$/i,"$1.m.").toLowerCase()),o=a);var s=$(".js-icon-night-time"),r=$(".js-icon-day-time"),l=i.hour,d=l>=20||l<7;d!==n&&(s.toggleClass("hidden",!d),r.toggleClass("hidden",d),n=d)}),1e3)}$(".js-offer-individual-message-duration").on("change",(function(){$(".js-offer-individual-message-duration-wrapper").addClass("active")})),$(".js-individual-message-send").on("click",(function(){$(".js-individual-message-form").submit()}))}));var e=function(e){this.$form=$(e),this.classes={activeStage:"modal-individual-message__stage--active"};var t=this;this.init=function(){this.setStages()},this.setStages=function(){t.stages=t.$form.find("[data-stage]")},this.hasNextStage=function(){return t.stages.last().data("stage")!==t.getCurrentPosition()},this.getCurrentStage=function(){return t.stages.filter("."+t.classes.activeStage)},this.getCurrentPosition=function(){return t.getCurrentStage().data("stage")},this.setStage=function(e){t.stages.removeClass(t.classes.activeStage).filter('[data-stage="'+e+'"]').addClass(t.classes.activeStage)},this.nextStage=function(){return!!t.hasNextStage()&&(t.setStage(t.getCurrentPosition()+1),!0)},this.init()}},26259:function(){window.popupAllowConversations=function(e,t,o){var n=window.IS_MARKET_APP_RU&&window.isChat,i="",a=e,s=t;void 0===a&&(a="allowConversations"),void 0===s&&(s="notAllowConversations"),i+=n?'<div class="popup__header"><div class="popup__header-title">'+l("allowConversation","components/popup-allow-conversations")+'</div></div><div class="popup__body"><p>'+l("allowSendMessageAgain","components/popup-allow-conversations")+'</p></div><div class="popup__footer"><button class="kw-button kw-button--gray-border popup-close-js" id="'+s+'">'+l("dontAllow","components/popup-allow-conversations")+'</button><button class="kw-button kw-button--green popup-close-js" id="'+a+'">'+l("allow","components/popup-allow-conversations")+"</button></div>":'<h1 class="popup__title">'+l("allowConversation","components/popup-allow-conversations")+'</h1><hr class="gray mt20 balance-popup__line">'+l("letSendMessageAgain","components/popup-allow-conversations")+'<div class="popup__buttons-flexible"><button class="popup__button white-btn popup-close-js" id="'+s+'">'+l("noIDont","components/popup-allow-conversations")+'</button><button class="popup__button green-btn popup-close-js" id="'+a+'">'+l("yesIDo","components/popup-allow-conversations")+"</button></div>",show_popup(i,"popup-unblock","",window.isChat||o?"popup_position_centered"+(n?" popup--light popup-allow-conversations":""):"")}}},t={};function o(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,o),a.exports}Object.defineProperty(o,"p",{get:function(){try{if("string"!=typeof chunkCdnUrl)throw new Error("WebpackRequireFrom: 'chunkCdnUrl' is not a string or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");return chunkCdnUrl}catch(e){return console.error(e),"/"}},set:function(e){console.warn("WebpackRequireFrom: something is trying to override webpack public path. Ignoring the new value"+e+".")}}),function(){"use strict";function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var t=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.selectors={notVerifiedProfile:".js-not-verified-profile",sendEmailConfirmation:".js-send-email-confirmation",emailTitle:".js-email-title"}}var o,n,i;return o=t,(n=[{key:"showNotVerified",value:function(){var e=this,t=$(this.selectors.notVerifiedProfile),o=$(this.selectors.sendEmailConfirmation);t.modal("show"),o.off("click").on("click",(function(){window.AfterRegistrationEvents.reSendEmail(),$("html, body").animate({scrollTop:$(e.selectors.emailTitle).offset().top-100},200)}))}},{key:"checkEmail",value:function(){return"undefined"==typeof isEmailVerified||!1!==isEmailVerified||(this.showNotVerified(),!1)}}])&&e(o.prototype,n),i&&e(o,i),Object.defineProperty(o,"prototype",{writable:!1}),t}();function n(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}window.CheckEmailVerified=new t;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,o,i;return t=e,(o=[{key:"init",value:function(e,t){var o=this;this.selectors={optgroupDurations:".js-optgroup-durations",optgroupDurationsFull:".js-optgroup-durations-full"},this.selectedValue=null,this.$select=e,this.$select.on("chosen:ready",(function(e){o.onReady(e)})),deferScript("chosenJquery",(function(){o.$select.chosen(t)}),window.isPageProfile||window.isChat),this.$select.on("change",(function(){o.selectedValue=o.$select.val()})),this.$select.on("chosen:showing_dropdown",this.onShowingDropdown.bind(this)),this.$select.on("chosen:hiding_dropdown",this.onHidingDropdown.bind(this))}},{key:"onShowingDropdown",value:function(e){this.openedValue=this.$select.val();var t=$(e.target).parent().find(".chosen-search-input"),o=t.data("searchVal");o&&(t.val(o).trigger("input"),t.trigger("keyup.chosen"))}},{key:"onHidingDropdown",value:function(e){var t=this,o=$(e.target),n=o.parent().find(".chosen-search-input"),i=n.data("searchVal");setTimeout((function(){if(t.selectedValue)i&&n.data("searchVal",t.selectedValue),t.selectedValue=null;else{var e=o.find('optgroup:not([disabled]) option[value="'+i+'"]');e.length>0&&(e[0].selected=!0,o.trigger("chosen:updated"))}}))}},{key:"onReady",value:function(e){var t=this,o=$(e.target),n=o.parent().find(".chosen-search-input"),i=o.find("option:last").attr("value");this.$optgroupDurations=o.find(this.selectors.optgroupDurations),this.$optgroupDurationsFull=o.find(this.selectors.optgroupDurationsFull),this.$optgroupDurationsFull.length>0&&(i=this.$optgroupDurationsFull.find("option:last").attr("value")),n.addClass("js-only-integer"),n.data("maxValue",parseInt(i)),n.data("minValue",1),n.on("only-integer:change",(function(){n.trigger("keyup.chosen")})),n.on("input keyup.chosen",(function(){var e=n.val(),i=n.data("searchVal");i=i||"",n.data("searchVal",e),""===e&&""!==i?(t.$optgroupDurations.removeAttr("disabled"),t.$optgroupDurationsFull.attr("disabled","disabled"),o.val(""),o.trigger("chosen:updated")):""!==e&&""===i&&(t.$optgroupDurationsFull.removeAttr("disabled"),t.$optgroupDurations.attr("disabled","disabled"),o.trigger("chosen:updated"))})),o.on("chosen:updated",(function(){var e=n.data("searchVal");e=e||"",n.val(e)}))}},{key:"clear",value:function(e){if(this.$optgroupDurations){var t=e.parent().find(".chosen-search-input");this.$optgroupDurations.removeAttr("disabled"),this.$optgroupDurationsFull.attr("disabled","disabled"),e.val(""),t.data("searchVal",""),t.val("").trigger("chosen:updated")}}}])&&n(t.prototype,o),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();window.chosenSearch=new i;o(27142),o(26259)}()}();
!function(t,e){"use strict";if(!t.PushStream){var n={},s=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],o=function(t){return(t<10?"0":"")+t};n.dateToUTCString=function(t){var e=o(t.getUTCHours())+":"+o(t.getUTCMinutes())+":"+o(t.getUTCSeconds());return s[t.getUTCDay()]+", "+o(t.getUTCDate())+" "+i[t.getUTCMonth()]+" "+t.getUTCFullYear()+" "+e+" GMT"};var r=function(){for(var t=arguments[0]||{},e=0;e<arguments.length;e++){var n=arguments[e];for(var s in n)n.hasOwnProperty&&!n.hasOwnProperty(s)||(t[s]=n[s])}return t},a=/^[\],:{}\s]*$/,c=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,h=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,u=/(?:^|:|,)(?:\s*\[)+/g;n.parseJSON=function(e){if(!e||!_(e))return null;if(e=e.replace(/^\s*/,"").replace(/\s*$/,""),t.JSON&&t.JSON.parse)try{return t.JSON.parse(e)}catch(t){throw"Invalid JSON: "+e}if(a.test(e.replace(c,"@").replace(h,"]").replace(u,"")))return new Function("return "+e)();throw"Invalid JSON: "+e};var l=function(t){var e={};return e[t.tagArgument]="",e[t.timeArgument]="",e[t.eventIdArgument]="",t.messagesControlByArgument&&(e[t.tagArgument]=Number(t._etag),t._lastModified?e[t.timeArgument]=t._lastModified:t._lastEventId&&(e[t.eventIdArgument]=t._lastEventId)),e},m=function(){return(new Date).getTime()},d=function(){return{_:m()}},p=function(t){var e=t;if("object"==typeof t){for(var n in e="",t)t.hasOwnProperty&&!t.hasOwnProperty(n)||(e+="&"+n+"="+b(t[n]));e=e.substring(1)}return e||""},g=function(t,e){return t+(t.indexOf("?")<0?"?":"&")+p(e)},f=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},_=function(t){return"[object String]"===Object.prototype.toString.call(t)},y=function(t){return"[object Date]"===Object.prototype.toString.call(t)},v={logger:null,debug:function(){"debug"===D.LOG_LEVEL&&v._log.apply(v._log,arguments)},info:function(){"info"!==D.LOG_LEVEL&&"debug"!==D.LOG_LEVEL||v._log.apply(v._log,arguments)},error:function(){v._log.apply(v._log,arguments)},_initLogger:function(){var e=t.console;e&&e.log&&(e.log.apply?v.logger=e.log:"object"==typeof e.log&&Function.prototype.bind?v.logger=Function.prototype.bind.call(e.log,e):"object"==typeof e.log&&Function.prototype.call&&(v.logger=function(){Function.prototype.call.call(e.log,e,Array.prototype.slice.call(arguments))}))},_log:function(){if(v.logger||v._initLogger(),v.logger)try{v.logger.apply(t.console,arguments)}catch(e){v._initLogger(),v.logger&&v.logger.apply(t.console,arguments)}var n=e.getElementById(D.LOG_OUTPUT_ELEMENT_ID);if(n){for(var s="",i=0;i<arguments.length;i++)s+=arguments[i]+" ";n.innerHTML+=s+"\n";var o=n.innerHTML.split("\n");o.length>100&&(n.innerHTML=o.slice(-100).join("\n"))}}},S={_getXHRObject:function(e){var n=!1;if(e){try{n=new t.XDomainRequest}catch(t){}if(n)return n}try{n=new t.XMLHttpRequest}catch(e){try{n=new t.ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{n=new t.ActiveXObject("Microsoft.XMLHTTP")}catch(t){n=!1}}}return n},_send:function(e,n){(e=e||{}).timeout=e.timeout||3e4;var s=S._getXHRObject(e.crossDomain);if(s&&e.url){S.clear(e),e.xhr=s,t.XDomainRequest&&s instanceof t.XDomainRequest?(s.onload=function(){e.afterReceive&&e.afterReceive(s),e.success&&e.success(s.responseText)},s.onerror=s.ontimeout=function(){e.afterReceive&&e.afterReceive(s),e.error&&e.error(s.status)}):s.onreadystatechange=function(){4===s.readyState&&(S.clear(e),e.afterReceive&&e.afterReceive(s),200===s.status?e.success&&e.success(s.responseText):e.error&&e.error(s.status))},e.beforeOpen&&e.beforeOpen(s);var i={},o=null,a="GET";n?(o=p(e.data),a="POST"):i=e.data||{},s.open(a,g(e.url,r({},i,d())),!0),e.beforeSend&&e.beforeSend(s);return n?s.setRequestHeader&&(s.setRequestHeader("Accept","application/json"),s.setRequestHeader("Content-type","application/x-www-form-urlencoded")):e.timeoutId=t.setTimeout(function(){S.clear(e);try{s.abort()}catch(t){}e.error(304)},e.timeout+2e3),s.send(o),s}},_clear_xhr:function(t){t&&(t.onreadystatechange=null)},_clear_script:function(t){t&&(t.onerror=t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t))},_clear_timeout:function(t){t.timeoutId=O(t.timeoutId)},_clear_jsonp:function(e){var n=e.data.callback;n&&(t[n]=function(){t[n]=null})},clear:function(t){S._clear_timeout(t),S._clear_jsonp(t),S._clear_script(e.getElementById(t.scriptId)),S._clear_xhr(t.xhr)},jsonp:function(n){n.timeout=n.timeout||3e4,S.clear(n);var s=e.head||e.getElementsByTagName("head")[0],i=e.createElement("script"),o=m(),a=function(){S.clear(n);var t=m();n.error(t-o>n.timeout/2?304:403)};i.onerror=a,i.onload=i.onreadystatechange=function(t){i.readyState&&!/loaded|complete/.test(i.readyState)||(n.afterSuccess?(S.clear(n),n.load()):a())},n.beforeOpen&&n.beforeOpen({}),n.beforeSend&&n.beforeSend({}),n.timeoutId=t.setTimeout(a,n.timeout+2e3),n.scriptId=n.scriptId||m(),n.afterSuccess=null,n.data.callback=n.scriptId+"_onmessage_"+m(),t[n.data.callback]=function(){n.afterSuccess=!0,n.success.apply(null,arguments)};var c=g(n.url,r({},n.data,d()));i.setAttribute("src",c),i.setAttribute("async","async"),i.setAttribute("id",n.scriptId);try{s.insertBefore(i,s.firstChild)}catch(t){}return n},load:function(t){return S._send(t,!1)},post:function(t){return S._send(t,!0)}},b=function(e){return e?t.encodeURIComponent(e):""},C=function(e){return e?t.decodeURIComponent(e):""};n.parseMessage=function(t,e){var s=t;return _(t)&&(s=n.parseJSON(t)),{id:s[e.jsonIdKey],channel:s[e.jsonChannelKey],text:_(s[e.jsonTextKey])?C(s[e.jsonTextKey]):s[e.jsonTextKey],tag:s[e.jsonTagKey],time:s[e.jsonTimeKey],eventid:s[e.jsonEventIdKey]||""}};var T=function(t,e){var n,s="";for(var i in t)t.hasOwnProperty&&!t.hasOwnProperty(i)||(s+="/"+i+(e?(n=t[i]).backtrack?".b"+Number(n.backtrack):"":""));return s},E=function(t,e,n,s){var i=t.wrapper.type===N.TYPE,o=t.useSSL,a=w(o,t.port),c=i?o?"wss://":"ws://":o?"https://":"http://";c+=t.host,c+=a?":"+a:"",c+=e;var h=T(t.channels,s);if(t.channelsByArgument){var u={};u[t.channelsArgument]=h.substring(1),n=r({},n,u)}else c+=h;return g(c,n)},P=function(t){var e=w(t.useSSL,t.port),n=t.useSSL?"https://":"http://";return n+=t.host,n+=e?":"+e:"",n+=t.urlPrefixPublisher,n+="?id="+T(t.channels,!1)};n.extract_xss_domain=function(t){if(t.match(/^(\d{1,3}\.){3}\d{1,3}$/))return t;var e=t.split("."),n=Math.max(e.length-1,t.match(/(\w{4,}\.\w{2}|\.\w{3,})$/)?2:3);return e.slice(-1*n).join(".")};var w=function(t,e){return e=Number(e||(t?443:80)),!t&&80===e||t&&443===e?"":e};n.isCrossDomainUrl=function(n){if(!n)return!1;var s=e.createElement("a");s.href=n;var i=w("https:"===t.location.protocol,t.location.port),o=w("https:"===s.protocol,s.port);return t.location.protocol!==s.protocol||t.location.hostname!==s.hostname||i!==o};var I=function(t,e){return function(){return t.apply(e,arguments)}},O=function(e){return e&&t.clearTimeout(e),null},x=function(t){v.info("["+this.type+"] message received",arguments);var e=n.parseMessage(t.data,this.pushstream);e.tag&&(this.pushstream._etag=e.tag),e.time&&(this.pushstream._lastModified=e.time),e.eventid&&(this.pushstream._lastEventId=e.eventid),this.pushstream._onmessage(e.text,e.id,e.channel,e.eventid,!0,e.time)},L=function(){this.pushstream._onopen(),v.info("["+this.type+"] connection opened")},A=function(e){v.info("["+this.type+"] error (disconnected by server):",e),this.pushstream.readyState===D.OPEN&&this.type===M.TYPE&&"error"===e.type&&this.connection.readyState===t.EventSource.CONNECTING||(this._closeCurrentConnection(),this.pushstream._onerror({type:e&&("load"===e.type||"close"===e.type&&1006===e.code)||this.pushstream.readyState===D.CONNECTING?"load":"timeout"}))},N=function(e){if(!t.WebSocket&&!t.MozWebSocket)throw"WebSocket not supported";this.type=N.TYPE,this.pushstream=e,this.connection=null};N.TYPE="WebSocket",N.prototype={connect:function(){this._closeCurrentConnection();var e=r({},this.pushstream.extraParams(),d(),l(this.pushstream)),n=E(this.pushstream,this.pushstream.urlPrefixWebsocket,e,!this.pushstream._useControlArguments());this.connection=t.WebSocket?new t.WebSocket(n):new t.MozWebSocket(n),this.connection.onerror=I(A,this),this.connection.onclose=I(A,this),this.connection.onopen=I(L,this),this.connection.onmessage=I(x,this),v.info("[WebSocket] connecting to:",n)},disconnect:function(){this.connection&&(v.debug("[WebSocket] closing connection to:",this.connection.url),this.connection.onclose=null,this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.connection){try{this.connection.close()}catch(t){}this.connection=null}},sendMessage:function(t){this.connection&&this.connection.send(t)}};var M=function(e){if(!t.EventSource)throw"EventSource not supported";this.type=M.TYPE,this.pushstream=e,this.connection=null};M.TYPE="EventSource",M.prototype={connect:function(){this._closeCurrentConnection();var e=r({},this.pushstream.extraParams(),d(),l(this.pushstream)),n=E(this.pushstream,this.pushstream.urlPrefixEventsource,e,!this.pushstream._useControlArguments());this.connection=new t.EventSource(n),this.connection.onerror=I(A,this),this.connection.onopen=I(L,this),this.connection.onmessage=I(x,this),v.info("[EventSource] connecting to:",n)},disconnect:function(){this.connection&&(v.debug("[EventSource] closing connection to:",this.connection.url),this.connection.onclose=null,this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.connection){try{this.connection.close()}catch(t){}this.connection=null}}};var j=function(t){this.type=j.TYPE,this.pushstream=t,this.connection=null,this.url=null,this.frameloadtimer=null,this.pingtimer=null,this.iframeId="PushStreamManager_"+t.id};j.TYPE="Stream",j.prototype={connect:function(){this._closeCurrentConnection();var t=n.extract_xss_domain(this.pushstream.host);try{e.domain=t}catch(e){v.error("[Stream] (warning) problem setting document.domain = "+t+" (OBS: IE8 does not support set IP numbers as domain)")}var s=r({},this.pushstream.extraParams(),d(),{streamid:this.pushstream.id},l(this.pushstream));this.url=E(this.pushstream,this.pushstream.urlPrefixStream,s,!this.pushstream._useControlArguments()),v.debug("[Stream] connecting to:",this.url),this.loadFrame(this.url)},disconnect:function(){this.connection&&(v.debug("[Stream] closing connection to:",this.url),this._closeCurrentConnection(),this.pushstream._onclose())},_clear_iframe:function(){var t=e.getElementById(this.iframeId);t&&(t.onload=null,t.src="about:blank",t.parentNode&&t.parentNode.removeChild(t))},_closeCurrentConnection:function(){this._clear_iframe(),this.connection&&(this.pingtimer=O(this.pingtimer),this.frameloadtimer=O(this.frameloadtimer),this.connection=null,this.transferDoc=null,"function"==typeof t.CollectGarbage&&t.CollectGarbage())},loadFrame:function(n){this._clear_iframe();var s=null;if("ActiveXObject"in t){var i=new t.ActiveXObject("htmlfile");i.open(),i.write("<html><script>document.domain='"+e.domain+"';<\/script>"),i.write("<body><iframe id='"+this.iframeId+"' src='"+n+"'></iframe></body></html>"),i.parentWindow.PushStream=D,i.close(),s=i.getElementById(this.iframeId),this.transferDoc=i}else(s=e.createElement("IFRAME")).style.width="1px",s.style.height="1px",s.style.border="none",s.style.position="absolute",s.style.top="-10px",s.style.marginTop="-10px",s.style.zIndex="-20",s.PushStream=D,e.body.appendChild(s),s.setAttribute("src",n),s.setAttribute("id",this.iframeId);s.onload=I(A,this),this.connection=s,this.frameloadtimer=t.setTimeout(I(A,this),this.pushstream.timeout)},register:function(t){this.frameloadtimer=O(this.frameloadtimer),t.p=I(this.process,this),this.connection.onload=I(this._onframeloaded,this),this.pushstream._onopen(),this.setPingTimer(),v.info("[Stream] frame registered")},process:function(t,e,n,s,i,o){this.pingtimer=O(this.pingtimer),v.info("[Stream] message received",arguments),-1!==t&&(o&&(this.pushstream._etag=o),i&&(this.pushstream._lastModified=i),s&&(this.pushstream._lastEventId=s)),this.pushstream._onmessage(C(n),t,e,s||"",!0,i),this.setPingTimer()},_onframeloaded:function(){v.info("[Stream] frame loaded (disconnected by server)"),this.pushstream._onerror({type:"timeout"}),this.connection.onload=null,this.disconnect()},setPingTimer:function(){this.pingtimer&&O(this.pingtimer),this.pingtimer=t.setTimeout(I(A,this),this.pushstream.pingtimeout)}};var k=function(t){this.type=k.TYPE,this.pushstream=t,this.connection=null,this.opentimer=null,this.messagesQueue=[],this._linkedInternalListen=I(this._internalListen,this),this.xhrSettings={timeout:this.pushstream.timeout,data:{},url:null,success:I(this.onmessage,this),error:I(this.onerror,this),load:I(this.onload,this),beforeSend:I(this.beforeSend,this),afterReceive:I(this.afterReceive,this)}};k.TYPE="LongPolling",k.prototype={connect:function(){this.messagesQueue=[],this._closeCurrentConnection(),this.urlWithBacktrack=E(this.pushstream,this.pushstream.urlPrefixLongpolling,{},!0),this.urlWithoutBacktrack=E(this.pushstream,this.pushstream.urlPrefixLongpolling,{},!1),this.xhrSettings.url=this.urlWithBacktrack,this.useJSONP=this.pushstream._crossDomain||this.pushstream.useJSONP,this.xhrSettings.scriptId="PushStreamManager_"+this.pushstream.id,this.useJSONP&&(this.pushstream.messagesControlByArgument=!0),this._listen(),this.opentimer=t.setTimeout(I(L,this),150),v.info("[LongPolling] connecting to:",this.xhrSettings.url)},_listen:function(){this._internalListenTimeout&&O(this._internalListenTimeout),this._internalListenTimeout=t.setTimeout(this._linkedInternalListen,100)},_internalListen:function(){this.pushstream._keepConnected&&(this.xhrSettings.url=this.pushstream._useControlArguments()?this.urlWithoutBacktrack:this.urlWithBacktrack,this.xhrSettings.data=r({},this.pushstream.extraParams(),this.xhrSettings.data,l(this.pushstream)),this.useJSONP?this.connection=S.jsonp(this.xhrSettings):this.connection||(this.connection=S.load(this.xhrSettings)))},disconnect:function(){this.connection&&(v.debug("[LongPolling] closing connection to:",this.xhrSettings.url),this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.opentimer=O(this.opentimer),this.connection){try{this.connection.abort()}catch(t){try{S.clear(this.connection)}catch(t){}}this.connection=null,this.xhrSettings.url=null}},beforeSend:function(t){this.pushstream.messagesControlByArgument||(t.setRequestHeader("If-None-Match",this.pushstream._etag),t.setRequestHeader("If-Modified-Since",this.pushstream._lastModified))},afterReceive:function(t){this.pushstream.messagesControlByArgument||(this.pushstream._etag=t.getResponseHeader("Etag"),this.pushstream._lastModified=t.getResponseHeader("Last-Modified")),this.connection=null},onerror:function(t){this._closeCurrentConnection(),this.pushstream._keepConnected&&(304===t?this._listen():(v.info("[LongPolling] error (disconnected by server):",t),this.pushstream._onerror({type:403===t||this.pushstream.readyState===D.CONNECTING?"load":"timeout"})))},onload:function(){this._listen()},onmessage:function(t){this._internalListenTimeout&&O(this._internalListenTimeout),v.info("[LongPolling] message received",t);for(var e=null,s=f(t)?t:t.replace(/\}\{/g,"}\r\n{").split("\r\n"),i=0;i<s.length;i++)s[i]&&(e=n.parseMessage(s[i],this.pushstream),this.messagesQueue.push(e),this.pushstream.messagesControlByArgument&&e.time&&(this.pushstream._etag=e.tag,this.pushstream._lastModified=e.time));for(this._listen();this.messagesQueue.length>0;){var o=this.messagesQueue.shift();this.pushstream._onmessage(o.text,o.id,o.channel,o.eventid,0===this.messagesQueue.length,o.time)}}};var R=[],D=function(e){e=e||{},this.id=R.push(this)-1,this.useSSL=e.useSSL||!1,this.host=e.host||t.location.hostname,this.port=Number(e.port||(this.useSSL?443:80)),this.timeout=e.timeout||3e4,this.pingtimeout=e.pingtimeout||3e4,this.reconnectOnTimeoutInterval=e.reconnectOnTimeoutInterval||3e3,this.reconnectOnChannelUnavailableInterval=e.reconnectOnChannelUnavailableInterval||6e4,this.autoReconnect=!1!==e.autoReconnect,this.lastEventId=e.lastEventId||null,this.messagesPublishedAfter=e.messagesPublishedAfter,this.messagesControlByArgument=e.messagesControlByArgument||!1,this.tagArgument=e.tagArgument||"tag",this.timeArgument=e.timeArgument||"time",this.eventIdArgument=e.eventIdArgument||"eventid",this.useJSONP=e.useJSONP||!1,this._reconnecttimer=null,this._etag=0,this._lastModified=null,this._lastEventId=null,this.urlPrefixPublisher=e.urlPrefixPublisher||"/pub",this.urlPrefixStream=e.urlPrefixStream||"/sub",this.urlPrefixEventsource=e.urlPrefixEventsource||"/ev",this.urlPrefixLongpolling=e.urlPrefixLongpolling||"/lp",this.urlPrefixWebsocket=e.urlPrefixWebsocket||"/ws",this.jsonIdKey=e.jsonIdKey||"id",this.jsonChannelKey=e.jsonChannelKey||"channel",this.jsonTextKey=e.jsonTextKey||"text",this.jsonTagKey=e.jsonTagKey||"tag",this.jsonTimeKey=e.jsonTimeKey||"time",this.jsonEventIdKey=e.jsonEventIdKey||"eventid",this.modes=(e.modes||"eventsource|websocket|stream|longpolling").split("|"),this.wrappers=[],this.wrapper=null,this.onchanneldeleted=e.onchanneldeleted||null,this.onmessage=e.onmessage||null,this.onerror=e.onerror||null,this.onopen=e.onopen||null,this.onstatuschange=e.onstatuschange||null,this.extraParams=e.extraParams||function(){return{}},this.channels={},this.channelsCount=0,this.channelsByArgument=e.channelsByArgument||!1,this.channelsArgument=e.channelsArgument||"channels",this._crossDomain=n.isCrossDomainUrl(P(this));for(var s=0;s<this.modes.length;s++)try{var i=null;switch(this.modes[s]){case"websocket":i=new N(this);break;case"eventsource":i=new M(this);break;case"longpolling":i=new k(this);break;case"stream":i=new j(this)}this.wrappers[this.wrappers.length]=i}catch(t){v.info(t)}this.readyState=0};D.LOG_LEVEL="error",D.LOG_OUTPUT_ELEMENT_ID="Log4jsLogOutput",D.CLOSED=0,D.CONNECTING=1,D.OPEN=2,D.prototype={addChannel:function(t,e){if(b(t)!==t)throw"Invalid channel name! Channel has to be a set of [a-zA-Z0-9]";if(v.debug("entering addChannel"),void 0!==this.channels[t])throw"Cannot add channel "+t+": already subscribed";e=e||{},v.info("adding channel",t,e),this.channels[t]=e,this.channelsCount++,this.readyState!==D.CLOSED&&this.connect(),v.debug("leaving addChannel")},removeChannel:function(t){this.channels[t]&&(v.info("removing channel",t),delete this.channels[t],this.channelsCount--)},removeAllChannels:function(){v.info("removing all channels"),this.channels={},this.channelsCount=0},_setState:function(t){this.readyState!==t&&(v.info("status changed",t),this.readyState=t,this.onstatuschange&&this.onstatuschange(this.readyState))},connect:function(){if(v.debug("entering connect"),!this.host)throw"PushStream host not specified";if(isNaN(this.port))throw"PushStream port not specified";if(!this.channelsCount)throw"No channels specified";if(0===this.wrappers.length)throw"No available support for this browser";this._keepConnected=!0,this._lastUsedMode=0,this._deferredConnect(1e3),v.debug("leaving connect")},disconnect:function(){v.debug("entering disconnect"),this._keepConnected=!1,this._disconnect(),this._setState(D.CLOSED),v.info("disconnected"),v.debug("leaving disconnect")},_useControlArguments:function(){return this.messagesControlByArgument&&(null!==this._lastModified||null!==this._lastEventId)},_deferredConnect:function(e){v.info("deferred connect",e,this._reconnecttimer),this._reconnecttimer=O(this._reconnecttimer),this._reconnecttimer=t.setTimeout(I(this._connect,this),e)},_connect:function(){if(null===this._lastEventId&&(this._lastEventId=this.lastEventId),null===this._lastModified){var t=this.messagesPublishedAfter;if(!y(t)){var e=Number(this.messagesPublishedAfter);e>0?(t=new Date).setTime(t.getTime()-1e3*e):e<0&&(t=new Date(0))}y(t)&&(this._lastModified=n.dateToUTCString(t))}this._disconnect(),this._setState(D.CONNECTING),this.wrapper=this.wrappers[this._lastUsedMode++%this.wrappers.length];try{this.wrapper.connect()}catch(t){this.wrapper&&this.wrapper.disconnect()}},_disconnect:function(){this._reconnecttimer=O(this._reconnecttimer),this.wrapper&&this.wrapper.disconnect()},_onopen:function(){this.onopen&&this.onopen(),this._reconnecttimer=O(this._reconnecttimer),this._setState(D.OPEN),this._lastUsedMode>0&&this._lastUsedMode--},_onclose:function(){this._reconnecttimer=O(this._reconnecttimer),this._setState(D.CLOSED),this._reconnect(this.reconnectOnTimeoutInterval)},_onmessage:function(t,e,n,s,i,o){v.debug("message",t,e,n,s,i,o),-2===e?this.onchanneldeleted&&this.onchanneldeleted(n):e>0&&this.onmessage&&this.onmessage(t,e,n,s,i,o)},_onerror:function(t){this._setState(D.CLOSED),this._reconnect("timeout"===t.type?this.reconnectOnTimeoutInterval:this.reconnectOnChannelUnavailableInterval),this.onerror&&this.onerror(t)},_reconnect:function(e){this.autoReconnect&&this._keepConnected&&!this._reconnecttimer&&this.readyState!==D.CONNECTING&&(v.info("trying to reconnect in",e),this._reconnecttimer=t.setTimeout(I(this._connect,this),e))},sendMessage:function(t,e,n){t=b(t),this.wrapper.type===N.TYPE?(this.wrapper.sendMessage(t),e&&e()):S.post({url:P(this),data:t,success:e,error:n,crossDomain:this._crossDomain})}},D.sendMessage=function(t,e,n,s){S.post({url:t,data:b(e),success:n,error:s})},D.register=function(t){var e=t.window.location.href.match(/streamid=([0-9]*)&?/);e[1]&&R[e[1]]&&R[e[1]].wrapper.register(t)},D.unload=function(){for(var t=0;t<R.length;t++)try{R[t].disconnect()}catch(t){}},t.PushStream=D,t.PushStreamManager=R,t.attachEvent&&t.attachEvent("onunload",D.unload),t.addEventListener&&t.addEventListener.call(t,"unload",D.unload,!1)}}(window,document);window.defferScripts.triggerExecuted("pushstreamJs");